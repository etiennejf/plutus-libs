<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.Tx.Constraints.Pretty</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html"><span class="hs-identifier">Cooked.MockChain.UtxoState</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Wallet.html"><span class="hs-identifier">Cooked.MockChain.Wallet</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html"><span class="hs-identifier">Cooked.Tx.Constraints.Type</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unspentOutputs</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Scripts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Typed.Scripts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DatumType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TypedValidator</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">validatorScript</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.V1.Scripts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.IsData.Class</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Doc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;+&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PP</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span id="local-6989586621679559987"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyEnum"><span class="hs-identifier hs-type">prettyEnum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559987"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559987"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559987"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559987"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-24"></span><span id="prettyEnum"><span class="annot"><span class="annottext">prettyEnum :: Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyEnum"><span class="hs-identifier hs-var hs-var">prettyEnum</span></a></span></span><span> </span><span id="local-6989586621679559876"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559876"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span id="local-6989586621679559875"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559875"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679559874"><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679559874"><span class="hs-identifier hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559876"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559875"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679559874"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span id="local-6989586621679559871"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyTxSkel"><span class="hs-identifier hs-type">prettyTxSkel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.MockChain.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559871"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-28"></span><span id="prettyTxSkel"><span class="annot"><span class="annottext">prettyTxSkel :: [Wallet] -&gt; TxSkel -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyTxSkel"><span class="hs-identifier hs-var hs-var">prettyTxSkel</span></a></span></span><span> </span><span id="local-6989586621679559869"><span class="annot"><span class="annottext">[Wallet]
</span><a href="#local-6989586621679559869"><span class="hs-identifier hs-var">signers</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span id="local-6989586621679559867"><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679559867"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621679559866"><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679559866"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679559865"><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679559865"><span class="hs-identifier hs-var">constraintsSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679559864"><span class="annot"><span class="annottext">[MiscConstraint]
</span><a href="#local-6989586621679559864"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-type">:=&gt;:</span></a></span><span> </span><span id="local-6989586621679559862"><span class="annot"><span class="annottext">[OutConstraint]
</span><a href="#local-6989586621679559862"><span class="hs-identifier hs-var">ocs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constraints -&gt; Constraints
forall a. ConstraintsSpec a =&gt; a -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#toConstraints"><span class="hs-identifier hs-var">toConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679559865"><span class="hs-identifier hs-var">constraintsSpec</span></a></span><span>
</span><span id="line-30"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; [Doc ann]) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-32"></span><span>          </span><span class="annot"><span class="annottext">[Maybe (Doc ann)] -&gt; [Doc ann]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-33"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Signers:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.list</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Wallet -&gt; Doc ann) -&gt; [Wallet] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PubKeyHash -&gt; Doc ann
forall ann. PubKeyHash -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyWallet"><span class="hs-identifier hs-var">prettyWallet</span></a></span><span> </span><span class="annot"><span class="annottext">(PubKeyHash -&gt; Doc ann)
-&gt; (Wallet -&gt; PubKeyHash) -&gt; Wallet -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; PubKeyHash
</span><a href="Cooked.MockChain.Wallet.html#walletPKHash"><span class="hs-identifier hs-var">walletPKHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Wallet]
</span><a href="#local-6989586621679559869"><span class="hs-identifier hs-var">signers</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>              </span><span class="annot"><span class="annottext">(x -&gt; Doc ann) -&gt; Maybe x -&gt; Maybe (Doc ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Label:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (x -&gt; Doc ann) -&gt; x -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatum"><span class="hs-identifier hs-var">prettyDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679559867"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>              </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Maybe (Doc ann) -&gt; Maybe (Doc ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Opts:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOpts -&gt; Maybe (Doc ann)
forall ann. TxOpts -&gt; Maybe (Doc ann)
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyOpts"><span class="hs-identifier hs-var">prettyOpts</span></a></span><span> </span><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679559866"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>              </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyEnum"><span class="hs-identifier hs-var">prettyEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Constraints:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;/\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(MiscConstraint -&gt; Doc ann) -&gt; [MiscConstraint] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MiscConstraint -&gt; Doc ann
forall ann. MiscConstraint -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyMiscConstraint"><span class="hs-identifier hs-var">prettyMiscConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">[MiscConstraint]
</span><a href="#local-6989586621679559864"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; [Doc ann] -&gt; [Doc ann]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(OutConstraint -&gt; Doc ann) -&gt; [OutConstraint] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">OutConstraint -&gt; Doc ann
forall ann. OutConstraint -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyOutConstraint"><span class="hs-identifier hs-var">prettyOutConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">[OutConstraint]
</span><a href="#local-6989586621679559862"><span class="hs-identifier hs-var">ocs</span></a></span><span>
</span><span id="line-37"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span id="local-6989586621679559997"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyWallet"><span class="hs-identifier hs-type">prettyWallet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559997"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-40"></span><span id="prettyWallet"><span class="annot"><span class="annottext">prettyWallet :: PubKeyHash -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyWallet"><span class="hs-identifier hs-var hs-var">prettyWallet</span></a></span></span><span> </span><span id="local-6989586621679559852"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679559852"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;wallet&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann -&gt; (Int -&gt; Doc ann) -&gt; Maybe Int -&gt; Doc ann
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559850"><span class="hs-identifier hs-var">phash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.parens</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559850"><span class="hs-identifier hs-var">phash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (Int -&gt; Doc ann) -&gt; Int -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;#&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (Int -&gt; Doc ann) -&gt; Int -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Doc ann)
-&gt; (PubKeyHash -&gt; Maybe Int) -&gt; PubKeyHash -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Maybe Int
</span><a href="Cooked.MockChain.Wallet.html#walletPKHashToId"><span class="hs-identifier hs-var">walletPKHashToId</span></a></span><span> </span><span class="annot"><span class="annottext">(PubKeyHash -&gt; Doc ann) -&gt; PubKeyHash -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679559852"><span class="hs-identifier hs-var">pkh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621679559850"><span class="annot"><span class="annottext">phash :: Doc ann
</span><a href="#local-6989586621679559850"><span class="hs-identifier hs-var hs-var">phash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyHash"><span class="hs-identifier hs-var">prettyHash</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679559852"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span id="local-6989586621679559984"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyOutConstraint"><span class="hs-identifier hs-type">prettyOutConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#OutConstraint"><span class="hs-identifier hs-type">OutConstraint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559984"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-46"></span><span id="prettyOutConstraint"><span class="annot"><span class="annottext">prettyOutConstraint :: OutConstraint -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyOutConstraint"><span class="hs-identifier hs-var hs-var">prettyOutConstraint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysScript"><span class="hs-identifier hs-type">PaysScript</span></a></span><span> </span><span id="local-6989586621679559844"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679559844"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679559843"><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679559843"><span class="hs-identifier hs-var">msc</span></a></span></span><span> </span><span id="local-6989586621679559842"><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679559842"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span id="local-6989586621679559841"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679559841"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyEnum"><span class="hs-identifier hs-var">prettyEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;PaysScript&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; Doc ann
forall ann. Address -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyAddressTypeAndHash"><span class="hs-identifier hs-var">prettyAddressTypeAndHash</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679559839"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((DatumType a, Value) -&gt; Doc ann)
-&gt; [(DatumType a, Value)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DatumType a -&gt; Value -&gt; Doc ann)
-&gt; (DatumType a, Value) -&gt; Doc ann
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedValidator a -&gt; DatumType a -&gt; Value -&gt; Doc ann
forall a ann.
Show (DatumType a) =&gt;
TypedValidator a -&gt; DatumType a -&gt; Value -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatumVal"><span class="hs-identifier hs-var">prettyDatumVal</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679559844"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679559842"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679559841"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621679559839"><span class="annot"><span class="annottext">addr :: Address
</span><a href="#local-6989586621679559839"><span class="hs-identifier hs-var hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidatorHash -&gt; Address
</span><span class="hs-identifier hs-var">Pl.scriptHashAddress</span></span><span> </span><span class="annot"><span class="annottext">(ValidatorHash -&gt; Address) -&gt; ValidatorHash -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Validator -&gt; ValidatorHash
</span><span class="hs-identifier hs-var">Pl.validatorHash</span></span><span> </span><span class="annot"><span class="annottext">(Validator -&gt; ValidatorHash) -&gt; Validator -&gt; ValidatorHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; Validator
forall a. TypedValidator a -&gt; Validator
</span><span class="hs-identifier hs-var">Pl.validatorScript</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679559844"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">addressStakingCredential :: Maybe StakingCredential
</span><span class="hs-identifier hs-var">Pl.addressStakingCredential</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679559843"><span class="hs-identifier hs-var">msc</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-50"></span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyOutConstraint"><span class="hs-identifier hs-var">prettyOutConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysPKWithDatum"><span class="hs-identifier hs-type">PaysPKWithDatum</span></a></span><span> </span><span id="local-6989586621679559832"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679559832"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span id="local-6989586621679559831"><span class="annot"><span class="annottext">Maybe StakePubKeyHash
</span><a href="#local-6989586621679559831"><span class="hs-identifier hs-var">stak</span></a></span></span><span> </span><span id="local-6989586621679559830"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679559830"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span id="local-6989586621679559829"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679559829"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyEnum"><span class="hs-identifier hs-var">prettyEnum</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;PaysPK&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Doc ann
forall ann. PubKeyHash -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyWallet"><span class="hs-identifier hs-var">prettyWallet</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679559832"><span class="hs-identifier hs-var">pkh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.emptyDoc</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Maybe (Doc ann)] -&gt; [Doc ann]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-55"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(StakePubKeyHash -&gt; Doc ann)
-&gt; Maybe StakePubKeyHash -&gt; Maybe (Doc ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;StakePKH:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann)
-&gt; (StakePubKeyHash -&gt; Doc ann) -&gt; StakePubKeyHash -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StakePubKeyHash -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StakePubKeyHash
</span><a href="#local-6989586621679559831"><span class="hs-identifier hs-var">stak</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>          </span><span class="annot"><span class="annottext">(a -&gt; Doc ann) -&gt; Maybe a -&gt; Maybe (Doc ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Datum:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (a -&gt; Doc ann) -&gt; a -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatum"><span class="hs-identifier hs-var">prettyDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679559830"><span class="hs-identifier hs-var">dat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>          </span><span class="annot"><span class="annottext">Value -&gt; Maybe (Doc ann)
forall ann. Value -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#mPrettyValue"><span class="hs-identifier hs-var">mPrettyValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679559829"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-58"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span id="local-6989586621679559986"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyMiscConstraint"><span class="hs-identifier hs-type">prettyMiscConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559986"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-62"></span><span id="prettyMiscConstraint"><span class="annot"><span class="annottext">prettyMiscConstraint :: MiscConstraint -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyMiscConstraint"><span class="hs-identifier hs-var hs-var">prettyMiscConstraint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsPK"><span class="hs-identifier hs-type">SpendsPK</span></a></span><span> </span><span id="local-6989586621679559825"><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679559825"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679559824"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559824"><span class="hs-identifier hs-var">ppAddr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679559823"><span class="annot"><span class="annottext">Maybe (Doc ann)
</span><a href="#local-6989586621679559823"><span class="hs-identifier hs-var">mppVal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; (Doc ann, Maybe (Doc ann))
forall ann. TxOut -&gt; (Doc ann, Maybe (Doc ann))
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyTxOut"><span class="hs-identifier hs-var">prettyTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; (Doc ann, Maybe (Doc ann)))
-&gt; TxOut -&gt; (Doc ann, Maybe (Doc ann))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; TxOut
</span><span class="hs-identifier hs-var">Pl.toTxOut</span></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTxOut -&gt; TxOut) -&gt; ChainIndexTxOut -&gt; TxOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SpendableOut -&gt; ChainIndexTxOut
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679559825"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-64"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyEnum"><span class="hs-identifier hs-var">prettyEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;SpendsPK&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Doc ann)] -&gt; [Doc ann]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559824"><span class="hs-identifier hs-var">ppAddr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (Doc ann)
</span><a href="#local-6989586621679559823"><span class="hs-identifier hs-var">mppVal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyMiscConstraint"><span class="hs-identifier hs-var">prettyMiscConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Mints"><span class="hs-identifier hs-type">Mints</span></a></span><span> </span><span id="local-6989586621679559819"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679559819"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span id="local-6989586621679559818"><span class="annot"><span class="annottext">[MintingPolicy]
</span><a href="#local-6989586621679559818"><span class="hs-identifier hs-var">policies</span></a></span></span><span> </span><span id="local-6989586621679559817"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679559817"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyEnum"><span class="hs-identifier hs-var">prettyEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Mints&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">[Maybe (Doc ann)] -&gt; [Doc ann]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-68"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe (Doc ann)
forall ann. Value -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#mPrettyValue"><span class="hs-identifier hs-var">mPrettyValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679559817"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>        </span><span class="annot"><span class="annottext">(a -&gt; Doc ann) -&gt; Maybe a -&gt; Maybe (Doc ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Redeemer:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (a -&gt; Doc ann) -&gt; a -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatum"><span class="hs-identifier hs-var">prettyDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679559819"><span class="hs-identifier hs-var">mr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Policies:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.list</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MintingPolicy -&gt; Doc ann) -&gt; [MintingPolicy] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MintingPolicy -&gt; Doc ann
forall ann. MintingPolicy -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyMintingPolicy"><span class="hs-identifier hs-var">prettyMintingPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">[MintingPolicy]
</span><a href="#local-6989586621679559818"><span class="hs-identifier hs-var">policies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyMiscConstraint"><span class="hs-identifier hs-var">prettyMiscConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SignedBy"><span class="hs-identifier hs-type">SignedBy</span></a></span><span> </span><span id="local-6989586621679559814"><span class="annot"><span class="annottext">[PubKeyHash]
</span><a href="#local-6989586621679559814"><span class="hs-identifier hs-var">pkhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyEnum"><span class="hs-identifier hs-var">prettyEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;SignedBy&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Doc ann
forall ann. PubKeyHash -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyWallet"><span class="hs-identifier hs-var">prettyWallet</span></a></span><span> </span><span class="annot"><span class="annottext">(PubKeyHash -&gt; Doc ann) -&gt; [PubKeyHash] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PubKeyHash]
</span><a href="#local-6989586621679559814"><span class="hs-identifier hs-var">pkhs</span></a></span><span>
</span><span id="line-73"></span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyMiscConstraint"><span class="hs-identifier hs-var">prettyMiscConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsScript"><span class="hs-identifier hs-type">SpendsScript</span></a></span><span> </span><span id="local-6989586621679559811"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679559811"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679559810"><span class="annot"><span class="annottext">RedeemerType a
</span><a href="#local-6989586621679559810"><span class="hs-identifier hs-var">red</span></a></span></span><span> </span><span id="local-6989586621679559809"><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679559809"><span class="hs-identifier hs-var">spOut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyEnum"><span class="hs-identifier hs-var">prettyEnum</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;SpendsScript&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; Doc ann
forall a ann. TypedValidator a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyTypedValidator"><span class="hs-identifier hs-var">prettyTypedValidator</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679559811"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Redeemer:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">RedeemerType a -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.viaShow</span></span><span> </span><span class="annot"><span class="annottext">RedeemerType a
</span><a href="#local-6989586621679559810"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; SpendableOut -&gt; Doc ann
forall a ann.
(UnsafeFromData (DatumType a), Show (DatumType a)) =&gt;
TypedValidator a -&gt; SpendableOut -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyScriptOutputDatum"><span class="hs-identifier hs-var">prettyScriptOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679559811"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679559809"><span class="hs-identifier hs-var">spOut</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyMiscConstraint"><span class="hs-identifier hs-var">prettyMiscConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Before"><span class="hs-identifier hs-type">Before</span></a></span><span> </span><span id="local-6989586621679559804"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679559804"><span class="hs-identifier hs-var">time</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Before:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679559804"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyMiscConstraint"><span class="hs-identifier hs-var">prettyMiscConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#After"><span class="hs-identifier hs-type">After</span></a></span><span> </span><span id="local-6989586621679559802"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679559802"><span class="hs-identifier hs-var">time</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;After:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679559802"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-80"></span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyMiscConstraint"><span class="hs-identifier hs-var">prettyMiscConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ValidateIn"><span class="hs-identifier hs-type">ValidateIn</span></a></span><span> </span><span id="local-6989586621679559800"><span class="annot"><span class="annottext">POSIXTimeRange
</span><a href="#local-6989586621679559800"><span class="hs-identifier hs-var">timeRange</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;ValidateIn:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">POSIXTimeRange -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">POSIXTimeRange
</span><a href="#local-6989586621679559800"><span class="hs-identifier hs-var">timeRange</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span id="local-6989586621679559798"><span id="local-6989586621679559799"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyHash"><span class="hs-identifier hs-type">prettyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679559799"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679559799"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559798"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-83"></span><span id="prettyHash"><span class="annot"><span class="annottext">prettyHash :: a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyHash"><span class="hs-identifier hs-var hs-var">prettyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Doc ann) -&gt; (a -&gt; [Char]) -&gt; a -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; [Char]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; (a -&gt; [Char]) -&gt; a -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679559947"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyMintingPolicy"><span class="hs-identifier hs-type">prettyMintingPolicy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.MintingPolicy</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559947"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-86"></span><span id="prettyMintingPolicy"><span class="annot"><span class="annottext">prettyMintingPolicy :: MintingPolicy -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyMintingPolicy"><span class="hs-identifier hs-var hs-var">prettyMintingPolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyHash"><span class="hs-identifier hs-var">prettyHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MintingPolicyHash -&gt; Doc ann)
-&gt; (MintingPolicy -&gt; MintingPolicyHash) -&gt; MintingPolicy -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MintingPolicy -&gt; MintingPolicyHash
</span><span class="hs-identifier hs-var">Pl.mintingPolicyHash</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyScriptOutputDatum"><span class="hs-identifier hs-type">prettyScriptOutputDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679559939"><span class="annot"><a href="#local-6989586621679559939"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679559937"><span class="annot"><a href="#local-6989586621679559937"><span class="hs-identifier hs-type">ann</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.UnsafeFromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679559939"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679559939"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679559939"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559937"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-94"></span><span id="prettyScriptOutputDatum"><span class="annot"><span class="annottext">prettyScriptOutputDatum :: TypedValidator a -&gt; SpendableOut -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyScriptOutputDatum"><span class="hs-identifier hs-var hs-var">prettyScriptOutputDatum</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679559794"><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679559794"><span class="hs-identifier hs-var">chainIndexTxOut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679559793"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559793"><span class="hs-identifier hs-var">ppAddr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679559792"><span class="annot"><span class="annottext">Maybe (Doc ann)
</span><a href="#local-6989586621679559792"><span class="hs-identifier hs-var">mppVal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; (Doc ann, Maybe (Doc ann))
forall ann. TxOut -&gt; (Doc ann, Maybe (Doc ann))
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyTxOut"><span class="hs-identifier hs-var">prettyTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; (Doc ann, Maybe (Doc ann)))
-&gt; TxOut -&gt; (Doc ann, Maybe (Doc ann))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; TxOut
</span><span class="hs-identifier hs-var">Pl.toTxOut</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679559794"><span class="hs-identifier hs-var">chainIndexTxOut</span></a></span><span>
</span><span id="line-96"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.align</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-98"></span><span>          </span><span class="annot"><span class="annottext">[Maybe (Doc ann)] -&gt; [Doc ann]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-99"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Output&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;at&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679559793"><span class="hs-identifier hs-var">ppAddr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>              </span><span class="annot"><span class="annottext">Maybe (Doc ann)
</span><a href="#local-6989586621679559792"><span class="hs-identifier hs-var">mppVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679559794"><span class="hs-identifier hs-var">chainIndexTxOut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-102"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptChainIndexTxOut</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Either ValidatorHash Validator
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679559789"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679559789"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679559788"><span class="hs-identifier hs-type">typedDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679559939"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-104"></span><span>                      </span><span id="local-6989586621679559788"><span class="annot"><span class="annottext">typedDatum :: DatumType a
</span><a href="#local-6989586621679559788"><span class="hs-identifier hs-var hs-var">typedDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; DatumType a
forall a. UnsafeFromData a =&gt; BuiltinData -&gt; a
</span><span class="hs-identifier hs-var">Pl.unsafeFromBuiltinData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Datum -&gt; BuiltinData
</span><span class="hs-identifier hs-var hs-var">Pl.getDatum</span></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679559789"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Datum:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">DatumType a -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatum"><span class="hs-identifier hs-var">prettyDatum</span></a></span><span> </span><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679559788"><span class="hs-identifier hs-var">typedDatum</span></a></span><span>
</span><span id="line-106"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptChainIndexTxOut</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Either ValidatorHash Validator
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679559785"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679559785"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-107"></span><span>                  </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Datum hash:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyHash"><span class="hs-identifier hs-var">prettyHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679559785"><span class="hs-identifier hs-var">datumHash</span></a></span><span>
</span><span id="line-108"></span><span>                </span><span class="annot"><span class="annottext">ChainIndexTxOut
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe (Doc ann)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Not a script output&quot;</span></span><span>
</span><span id="line-109"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679559953"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyTxOut"><span class="hs-identifier hs-type">prettyTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559953"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559953"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-112"></span><span id="prettyTxOut"><span class="annot"><span class="annottext">prettyTxOut :: TxOut -&gt; (Doc ann, Maybe (Doc ann))
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyTxOut"><span class="hs-identifier hs-var hs-var">prettyTxOut</span></a></span></span><span> </span><span id="local-6989586621679559783"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679559783"><span class="hs-identifier hs-var">tout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Address -&gt; Doc ann
forall ann. Address -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyAddressTypeAndHash"><span class="hs-identifier hs-var">prettyAddressTypeAndHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; Doc ann) -&gt; Address -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Address
</span><span class="hs-identifier hs-var hs-var">Pl.txOutAddress</span></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679559783"><span class="hs-identifier hs-var">tout</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe (Doc ann)
forall ann. Value -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#mPrettyValue"><span class="hs-identifier hs-var">mPrettyValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe (Doc ann)) -&gt; Value -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Value
</span><span class="hs-identifier hs-var hs-var">Pl.txOutValue</span></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679559783"><span class="hs-identifier hs-var">tout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span id="local-6989586621679559940"><span id="local-6989586621679559941"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyTypedValidator"><span class="hs-identifier hs-type">prettyTypedValidator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679559941"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559940"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-115"></span><span id="prettyTypedValidator"><span class="annot"><span class="annottext">prettyTypedValidator :: TypedValidator a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyTypedValidator"><span class="hs-identifier hs-var hs-var">prettyTypedValidator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address -&gt; Doc ann
forall ann. Address -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyAddressTypeAndHash"><span class="hs-identifier hs-var">prettyAddressTypeAndHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; Doc ann)
-&gt; (TypedValidator a -&gt; Address) -&gt; TypedValidator a -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Validator -&gt; Address
</span><span class="hs-identifier hs-var">Pl.scriptAddress</span></span><span> </span><span class="annot"><span class="annottext">(Validator -&gt; Address)
-&gt; (TypedValidator a -&gt; Validator) -&gt; TypedValidator a -&gt; Address
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; Validator
forall a. TypedValidator a -&gt; Validator
</span><span class="hs-identifier hs-var">Pl.validatorScript</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679559964"><span id="local-6989586621679559965"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatumVal"><span class="hs-identifier hs-type">prettyDatumVal</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679559965"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679559965"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679559965"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559964"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-123"></span><span id="prettyDatumVal"><span class="annot"><span class="annottext">prettyDatumVal :: TypedValidator a -&gt; DatumType a -&gt; Value -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatumVal"><span class="hs-identifier hs-var hs-var">prettyDatumVal</span></a></span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679559779"><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679559779"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679559778"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679559778"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.align</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Doc ann)] -&gt; [Doc ann]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DatumType a -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatum"><span class="hs-identifier hs-var">prettyDatum</span></a></span><span> </span><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679559779"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe (Doc ann)
forall ann. Value -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#mPrettyValue"><span class="hs-identifier hs-var">mPrettyValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679559778"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | Prettifies a 'TxOpts'; returns 'Nothing' if we're looking at default options.</span><span>
</span><span id="line-127"></span><span id="local-6989586621679559988"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyOpts"><span class="hs-identifier hs-type">prettyOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559988"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-128"></span><span id="prettyOpts"><span class="annot"><span class="annottext">prettyOpts :: TxOpts -&gt; Maybe (Doc ann)
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyOpts"><span class="hs-identifier hs-var hs-var">prettyOpts</span></a></span></span><span> </span><span id="local-6989586621679559777"><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679559777"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Field TxOpts -&gt; Maybe (Doc ann)) -&gt; [Field TxOpts] -&gt; [Doc ann]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Field TxOpts -&gt; Maybe (Doc ann)
forall ann. Field TxOpts -&gt; Maybe (Doc ann)
</span><a href="#local-6989586621679559776"><span class="hs-identifier hs-var">cmpAgainstDefAndPrint</span></a></span><span> </span><span class="annot"><span class="annottext">[Field TxOpts]
</span><a href="#local-6989586621679559775"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Doc ann)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679559774"><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679559774"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.semi</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679559774"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679559909"><span class="annot"><a href="#local-6989586621679559776"><span class="hs-identifier hs-type">cmpAgainstDefAndPrint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559909"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679559776"><span class="annot"><span class="annottext">cmpAgainstDefAndPrint :: Field TxOpts -&gt; Maybe (Doc ann)
</span><a href="#local-6989586621679559776"><span class="hs-identifier hs-var hs-var">cmpAgainstDefAndPrint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span id="local-6989586621679559770"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559770"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679559769"><span class="annot"><span class="annottext">TxOpts -&gt; x
</span><a href="#local-6989586621679559769"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; x
</span><a href="#local-6989586621679559769"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679559777"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; x
</span><a href="#local-6989586621679559769"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TxOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Doc ann)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559770"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.viaShow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOpts -&gt; x
</span><a href="#local-6989586621679559769"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679559777"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-comment">-- Internal: if you add fields to TxOpts, make sure to add them here.</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="#local-6989586621679559775"><span class="hs-identifier hs-type">fields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679559775"><span class="annot"><span class="annottext">fields :: [Field TxOpts]
</span><a href="#local-6989586621679559775"><span class="hs-identifier hs-var hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (TxOpts -&gt; Bool) -&gt; Field TxOpts
forall x record.
(Show x, Eq x) =&gt;
[Char] -&gt; (record -&gt; x) -&gt; Field record
</span><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;adjustUnbalTx&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#adjustUnbalTx"><span class="hs-identifier hs-var hs-var">adjustUnbalTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; (TxOpts -&gt; Bool) -&gt; Field TxOpts
forall x record.
(Show x, Eq x) =&gt;
[Char] -&gt; (record -&gt; x) -&gt; Field record
</span><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;awaitTxConfirmed&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#awaitTxConfirmed"><span class="hs-identifier hs-var hs-var">awaitTxConfirmed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; (TxOpts -&gt; Bool) -&gt; Field TxOpts
forall x record.
(Show x, Eq x) =&gt;
[Char] -&gt; (record -&gt; x) -&gt; Field record
</span><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;autoSlotIncrease&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#autoSlotIncrease"><span class="hs-identifier hs-var hs-var">autoSlotIncrease</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; (TxOpts -&gt; RawModTx) -&gt; Field TxOpts
forall x record.
(Show x, Eq x) =&gt;
[Char] -&gt; (record -&gt; x) -&gt; Field record
</span><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unsafeModTx&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; RawModTx
</span><a href="Cooked.Tx.Constraints.Type.html#unsafeModTx"><span class="hs-identifier hs-var hs-var">unsafeModTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; (TxOpts -&gt; Bool) -&gt; Field TxOpts
forall x record.
(Show x, Eq x) =&gt;
[Char] -&gt; (record -&gt; x) -&gt; Field record
</span><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;balance&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#balance"><span class="hs-identifier hs-var hs-var">balance</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; (TxOpts -&gt; Collateral) -&gt; Field TxOpts
forall x record.
(Show x, Eq x) =&gt;
[Char] -&gt; (record -&gt; x) -&gt; Field record
</span><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collateral&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; Collateral
</span><a href="Cooked.Tx.Constraints.Type.html#collateral"><span class="hs-identifier hs-var hs-var">collateral</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; (TxOpts -&gt; BalanceOutputPolicy) -&gt; Field TxOpts
forall x record.
(Show x, Eq x) =&gt;
[Char] -&gt; (record -&gt; x) -&gt; Field record
</span><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;balanceOutputPolicy&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; BalanceOutputPolicy
</span><a href="Cooked.Tx.Constraints.Type.html#balanceOutputPolicy"><span class="hs-identifier hs-var hs-var">balanceOutputPolicy</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">data</span><span> </span><span id="Field"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-var">Field</span></a></span></span><span> </span><span id="local-6989586621679559759"><span class="annot"><a href="#local-6989586621679559759"><span class="hs-identifier hs-type">record</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621679559758"><span id="local-6989586621679559902"><span id="Field"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-var">Field</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679559758"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679559758"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679559902"><span class="hs-identifier hs-type">record</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679559758"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679559902"><span class="hs-identifier hs-type">record</span></a></span></span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- * Shortening Hashes from Show Instances</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | The 'prettyDatum' relies on Haskell's default show implementation,</span><span>
</span><span id="line-155"></span><span class="hs-comment">--  but it display shortened hashes. It is a big hack to detect hashes and</span><span>
</span><span id="line-156"></span><span class="hs-comment">--  it works in the vast majority of cases. It might shorten a string that</span><span>
</span><span id="line-157"></span><span class="hs-comment">--  /is not/ a hash iff such string has more than 24 hexadecimal characters,</span><span>
</span><span id="line-158"></span><span class="hs-comment">--  which arguably, is pretty unlikely for something that is not a hash.</span><span>
</span><span id="line-159"></span><span id="local-6989586621679559989"><span id="local-6989586621679559990"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatum"><span class="hs-identifier hs-type">prettyDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679559990"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679559990"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559989"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-160"></span><span id="prettyDatum"><span class="annot"><span class="annottext">prettyDatum :: a -&gt; Doc ann
</span><a href="Cooked.Tx.Constraints.Pretty.html#prettyDatum"><span class="hs-identifier hs-var hs-var">prettyDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.align</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (a -&gt; Doc ann) -&gt; a -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[WordPunct] -&gt; Doc ann
forall ann. [WordPunct] -&gt; Doc ann
</span><a href="#local-6989586621679559756"><span class="hs-identifier hs-var">prettyWordPunct</span></a></span><span> </span><span class="annot"><span class="annottext">([WordPunct] -&gt; Doc ann) -&gt; (a -&gt; [WordPunct]) -&gt; a -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(WordPunct -&gt; WordPunct) -&gt; [WordPunct] -&gt; [WordPunct]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WordPunct -&gt; WordPunct
</span><a href="#local-6989586621679559755"><span class="hs-identifier hs-var">fixHashes</span></a></span><span> </span><span class="annot"><span class="annottext">([WordPunct] -&gt; [WordPunct])
-&gt; (a -&gt; [WordPunct]) -&gt; a -&gt; [WordPunct]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WordPunct]
</span><a href="#local-6989586621679559754"><span class="hs-identifier hs-var">words'</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [WordPunct]) -&gt; (a -&gt; [Char]) -&gt; a -&gt; [WordPunct]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-comment">-- TODO: It might be worthwhile to make a little parser for haskell records</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- and actually prettify the output. Legibility is a massively important</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">-- factor for us to be able to diagnose tests that go wrong.</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679559753"><span class="annot"><span class="annottext">isHashChar :: Char -&gt; Bool
</span><a href="#local-6989586621679559753"><span class="hs-identifier hs-var hs-var">isHashChar</span></a></span></span><span> </span><span id="local-6989586621679559752"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679559752"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679559752"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679559752"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'f'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679559752"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><a href="#local-6989586621679559755"><span class="hs-identifier hs-type">fixHashes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#WordPunct"><span class="hs-identifier hs-type">WordPunct</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#WordPunct"><span class="hs-identifier hs-type">WordPunct</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679559755"><span class="annot"><span class="annottext">fixHashes :: WordPunct -&gt; WordPunct
</span><a href="#local-6989586621679559755"><span class="hs-identifier hs-var hs-var">fixHashes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Punct"><span class="hs-identifier hs-type">Punct</span></a></span><span> </span><span id="local-6989586621679559746"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559746"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; WordPunct
</span><a href="Cooked.Tx.Constraints.Pretty.html#Punct"><span class="hs-identifier hs-var">Punct</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559746"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><a href="#local-6989586621679559755"><span class="hs-identifier hs-var">fixHashes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679559744"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559744"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559744"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; WordPunct
</span><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559744"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679559753"><span class="hs-identifier hs-var">isHashChar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559744"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; WordPunct
</span><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; WordPunct) -&gt; [Char] -&gt; WordPunct
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; [Char]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559744"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; WordPunct
</span><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559744"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="#local-6989586621679559754"><span class="hs-identifier hs-type">words'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#WordPunct"><span class="hs-identifier hs-type">WordPunct</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679559754"><span class="annot"><span class="annottext">words' :: [Char] -&gt; [WordPunct]
</span><a href="#local-6989586621679559754"><span class="hs-identifier hs-var hs-var">words'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [WordPunct]) -&gt; [[Char]] -&gt; [WordPunct]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WordPunct]
</span><a href="#local-6989586621679559739"><span class="hs-identifier hs-var">splitPunct</span></a></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [WordPunct])
-&gt; ([Char] -&gt; [[Char]]) -&gt; [Char] -&gt; [WordPunct]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]]
</span><span class="hs-identifier hs-var">words</span></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><a href="#local-6989586621679559739"><span class="hs-identifier hs-type">splitPunct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#WordPunct"><span class="hs-identifier hs-type">WordPunct</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679559739"><span class="annot"><span class="annottext">splitPunct :: [Char] -&gt; [WordPunct]
</span><a href="#local-6989586621679559739"><span class="hs-identifier hs-var hs-var">splitPunct</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="#local-6989586621679559739"><span class="hs-identifier hs-var">splitPunct</span></a></span><span> </span><span id="local-6989586621679559737"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559737"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679559736"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559736"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679559735"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559735"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; ([Char], [Char])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPunctuation</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559737"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-181"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679559732"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559732"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679559731"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559731"><span class="hs-identifier hs-var">s''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; ([Char], [Char])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPunctuation</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559735"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-182"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WordPunct] -&gt; [WordPunct]
</span><a href="#local-6989586621679559729"><span class="hs-identifier hs-var">appP</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559736"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">([WordPunct] -&gt; [WordPunct]) -&gt; [WordPunct] -&gt; [WordPunct]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WordPunct] -&gt; [WordPunct]
</span><a href="#local-6989586621679559728"><span class="hs-identifier hs-var">appW</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559732"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">([WordPunct] -&gt; [WordPunct]) -&gt; [WordPunct] -&gt; [WordPunct]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WordPunct]
</span><a href="#local-6989586621679559739"><span class="hs-identifier hs-var">splitPunct</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559731"><span class="hs-identifier hs-var">s''</span></a></span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>        </span><span id="local-6989586621679559729"><span class="annot"><span class="annottext">appP :: [Char] -&gt; [WordPunct] -&gt; [WordPunct]
</span><a href="#local-6989586621679559729"><span class="hs-identifier hs-var hs-var">appP</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WordPunct] -&gt; [WordPunct]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="#local-6989586621679559729"><span class="hs-identifier hs-var">appP</span></a></span><span> </span><span id="local-6989586621679559726"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559726"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; WordPunct
</span><a href="Cooked.Tx.Constraints.Pretty.html#Punct"><span class="hs-identifier hs-var">Punct</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559726"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">WordPunct -&gt; [WordPunct] -&gt; [WordPunct]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679559728"><span class="annot"><span class="annottext">appW :: [Char] -&gt; [WordPunct] -&gt; [WordPunct]
</span><a href="#local-6989586621679559728"><span class="hs-identifier hs-var hs-var">appW</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WordPunct] -&gt; [WordPunct]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><a href="#local-6989586621679559728"><span class="hs-identifier hs-var">appW</span></a></span><span> </span><span id="local-6989586621679559725"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559725"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; WordPunct
</span><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559725"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">WordPunct -&gt; [WordPunct] -&gt; [WordPunct]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679559895"><span class="annot"><a href="#local-6989586621679559756"><span class="hs-identifier hs-type">prettyWordPunct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#WordPunct"><span class="hs-identifier hs-type">WordPunct</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679559895"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679559756"><span class="annot"><span class="annottext">prettyWordPunct :: [WordPunct] -&gt; Doc ann
</span><a href="#local-6989586621679559756"><span class="hs-identifier hs-var hs-var">prettyWordPunct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WordPunct] -&gt; Doc ann
forall ann. [WordPunct] -&gt; Doc ann
</span><a href="#local-6989586621679559724"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>        </span><span id="local-6989586621679559724"><span class="annot"><span class="annottext">go :: [WordPunct] -&gt; Doc ann
</span><a href="#local-6989586621679559724"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679559723"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559723"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679559722"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559722"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679559721"><span class="annot"><span class="annottext">[WordPunct]
</span><a href="#local-6989586621679559721"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559723"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[WordPunct] -&gt; Doc ann
</span><a href="#local-6989586621679559724"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; WordPunct
</span><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559722"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">WordPunct -&gt; [WordPunct] -&gt; [WordPunct]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WordPunct]
</span><a href="#local-6989586621679559721"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><a href="#local-6989586621679559724"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679559720"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559720"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Punct"><span class="hs-identifier hs-type">Punct</span></a></span><span> </span><span id="local-6989586621679559719"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559719"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679559718"><span class="annot"><span class="annottext">[WordPunct]
</span><a href="#local-6989586621679559718"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559720"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559720"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[WordPunct] -&gt; Doc ann
</span><a href="#local-6989586621679559724"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; WordPunct
</span><a href="Cooked.Tx.Constraints.Pretty.html#Punct"><span class="hs-identifier hs-var">Punct</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559719"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">WordPunct -&gt; [WordPunct] -&gt; [WordPunct]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WordPunct]
</span><a href="#local-6989586621679559718"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559720"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[WordPunct] -&gt; Doc ann
</span><a href="#local-6989586621679559724"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; WordPunct
</span><a href="Cooked.Tx.Constraints.Pretty.html#Punct"><span class="hs-identifier hs-var">Punct</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559719"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">WordPunct -&gt; [WordPunct] -&gt; [WordPunct]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WordPunct]
</span><a href="#local-6989586621679559718"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><a href="#local-6989586621679559724"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Punct"><span class="hs-identifier hs-type">Punct</span></a></span><span> </span><span id="local-6989586621679559717"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559717"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679559716"><span class="annot"><span class="annottext">[WordPunct]
</span><a href="#local-6989586621679559716"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559717"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[WordPunct] -&gt; Doc ann
</span><a href="#local-6989586621679559724"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[WordPunct]
</span><a href="#local-6989586621679559716"><span class="hs-identifier hs-var">zs</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><a href="#local-6989586621679559724"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679559715"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559715"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679559715"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><a href="#local-6989586621679559724"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.emptyDoc</span></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">data</span><span> </span><span id="WordPunct"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#WordPunct"><span class="hs-identifier hs-var">WordPunct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Word"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Word"><span class="hs-identifier hs-var">Word</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Punct"><span class="annot"><a href="Cooked.Tx.Constraints.Pretty.html#Punct"><span class="hs-identifier hs-var">Punct</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679559709"><span id="local-6989586621679559711"><span id="local-6989586621679559713"><span class="annot"><span class="annottext">Int -&gt; WordPunct -&gt; [Char] -&gt; [Char]
[WordPunct] -&gt; [Char] -&gt; [Char]
WordPunct -&gt; [Char]
(Int -&gt; WordPunct -&gt; [Char] -&gt; [Char])
-&gt; (WordPunct -&gt; [Char])
-&gt; ([WordPunct] -&gt; [Char] -&gt; [Char])
-&gt; Show WordPunct
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
showList :: [WordPunct] -&gt; [Char] -&gt; [Char]
$cshowList :: [WordPunct] -&gt; [Char] -&gt; [Char]
show :: WordPunct -&gt; [Char]
$cshow :: WordPunct -&gt; [Char]
showsPrec :: Int -&gt; WordPunct -&gt; [Char] -&gt; [Char]
$cshowsPrec :: Int -&gt; WordPunct -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span></pre></body></html>